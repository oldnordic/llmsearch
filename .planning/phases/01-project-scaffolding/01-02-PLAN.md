---
phase: 01-project-scaffolding
plan: 02
type: execute
depends_on: ["01-01"]
files_modified: [src/main.rs, src/cli.rs]
autonomous: true
---

<objective>
Define CLI argument structure using clap derive API.

Purpose: Create the command-line interface that accepts --root, --pattern, --glob, --limit, and --json flags. This provides the input layer for all search operations.
Output: Structured CLI args that can be used by main logic
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan creates Cargo.toml with clap dependency
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CLI args struct with clap derive</name>
  <files>src/cli.rs</files>
  <action>Create src/cli.rs with a `Cli` struct derived from `Parser`:

```rust
use clap::Parser;

/// LLM-native code search with structured JSON output
#[derive(Parser, Debug)]
#[command(name = "llmsearch")]
#[command(about = "Deterministic, structured search for LLM workflows", long_about = None)]
pub struct Cli {
    /// Root directory to search (default: current directory)
    #[arg(short, long, default_value = ".")]
    pub root: String,

    /// Regex pattern to search for
    #[arg(short, long)]
    pub pattern: String,

    /// File glob patterns (can be specified multiple times)
    #[arg(short, long)]
    pub glob: Vec<String>,

    /// Maximum number of results to return
    #[arg(short, long, default_value = "100")]
    pub limit: usize,

    /// Output results as JSON (structured format for LLMs)
    #[arg(long, default_value_t = false)]
    pub json: bool,
}
```

Use derive API (not builder API) for type safety and cleaner code.
Include all fields from PROJECT.md CLI interface.
</action>
  <verify>`cargo check` succeeds with no errors</verify>
  <done>Cli struct compiles with all required fields</done>
</task>

<task type="auto">
  <name>Task 2: Wire up CLI in main.rs</name>
  <files>src/main.rs</files>
  <action>Replace the contents of src/main.rs with:

```rust
mod cli;

use clap::Parser;

fn main() {
    let args = cli::Cli::parse();
    println!("{:#?}", args);
}
```

This temporary implementation just prints the args for verification.
Replace it in the next plan (01-03) with actual main loop structure.
</action>
  <verify>`cargo run -- --help` shows full help text with all options</verify>
  <done>`cargo run -- --pattern test --glob *.rs` prints parsed args without error</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo run -- --help` shows help with all 5 flags
- [ ] `cargo run -- --pattern foo --glob "*.rs" --limit 10 --json` parses correctly
- [ ] Default values work (running with no args uses defaults)
</verification>

<success_criteria>
- CLI struct defined with clap derive
- All required flags present: --root, --pattern, --glob, --limit, --json
- Help text displays correctly
- Args parse and print (temporary debug output)
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-scaffolding/01-02-SUMMARY.md`
</output>
