---
phase: 01-project-scaffolding
plan: 03
type: execute
depends_on: ["01-02"]
files_modified: [src/main.rs]
autonomous: true
---

<objective>
Create main binary entry point with structured program flow.

Purpose: Establish the skeletal main function that will be filled in by later phases. This provides the program structure and placeholder comments indicating where each phase's code will go.
Output: Clean main.rs with program flow skeleton
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan creates CLI args in src/cli.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create main program skeleton with placeholders</name>
  <files>src/main.rs</files>
  <action>Replace src/main.rs with a structured main function that shows the program flow:

```rust
mod cli;

use clap::Parser;

fn main() {
    let args = cli::Cli::parse();

    // Phase 2: File walking & ignore
    // TODO: Walk directory tree with .gitignore support
    let _files = vec![];

    // Phase 3: Pattern matching
    // TODO: Search file contents with regex, track byte offsets
    let _matches = vec![];

    // Phase 4: Line/column calculation
    // TODO: Convert byte offsets to line/col positions
    // TODO: Handle multi-byte UTF-8 correctly

    // Phase 5: Context extraction
    // TODO: Extract before/after context for each match

    // Phase 6: JSON output
    // TODO: Generate execution_id (UUID)
    // TODO: Serialize to JSON schema

    // Phase 7: Deterministic ordering
    // TODO: Sort by path then byte_start
    // TODO: Apply limit

    // Phase 8: CLI polish
    // TODO: Error handling, --json flag logic

    // Temporary: print args to show CLI works
    eprintln!("llmsearch scaffolding complete!");
    eprintln!("Args: {:#?}", args);
    eprintln!();
    eprintln!("Next: Implement phases 2-10 to add functionality.");
}
```

Key points:
- Use eprintln for temporary output (stderr = debug, stdout = results later)
- Add TODO comments for each phase showing what goes where
- Keep it minimal - this is just skeleton structure
</action>
  <verify>`cargo build` succeeds with no errors</verify>
  <done>Running binary prints scaffolding message with parsed args</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo build` succeeds
- [ ] `cargo run -- --pattern test` prints scaffolding message
- [ ] TODO comments clearly indicate where each phase contributes
</verification>

<success_criteria>
- Main function has clear program flow skeleton
- TODO comments map each phase to its contribution
- CLI args still parse correctly
- Binary runs without errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-scaffolding/01-03-SUMMARY.md`
</output>
