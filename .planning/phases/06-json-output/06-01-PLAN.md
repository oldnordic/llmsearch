---
phase: 06-json-output
plan: 01
type: execute
depends_on: []
files_modified: [src/main.rs]
autonomous: true
---

<objective>
Define JSON output structures with Serialize derives.

Purpose: Create the top-level JSON output schema that will contain execution_id, matches array, and metadata.
Output: Struct definitions with Serialize derives for JSON serialization
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 5 provides context extraction:
@.planning/phases/05-context-extraction/05-03-SUMMARY.md

# Current state:
@src/main.rs - Match struct has all fields from Phase 5
@Cargo.toml - serde and serde_json dependencies already present
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Serialize derive to Match struct</name>
  <files>src/main.rs</files>
  <action>Add #[derive(Serialize)] to the Match struct:
```rust
use serde::Serialize;

#[derive(Serialize)]
struct Match {
    file: String,
    byte_start: usize,
    byte_end: usize,
    matched_text: String,
    line_number: usize,
    column_number: usize,
    context_before: String,
    context_after: String,
}
```

Key notes:
- Add `use serde::Serialize;` import at top
- Keep all existing fields (no changes to data structure)
- This enables JSON serialization for Match instances
</action>
  <verify>`cargo build` succeeds without errors</verify>
  <done>Match struct has Serialize derive and compiles</done>
</task>

<task type="auto">
  <name>Task 2: Create SearchOutput struct for JSON schema</name>
  <files>src/main.rs</files>
  <action>Define the top-level output struct after Match:
```rust
#[derive(Serialize)]
struct SearchOutput {
    execution_id: String,  // Will be UUID in 06-02
    pattern: String,
    matches: Vec<Match>,
    match_count: usize,
}
```

This defines the JSON output schema:
- execution_id: Unique identifier for this search run (UUID in 06-02)
- pattern: The regex pattern searched for
- matches: Array of all Match results
- match_count: Total number of matches (convenience field)
</action>
  <verify>`cargo build` succeeds</verify>
  <done>SearchOutput struct defined with Serialize derive</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo build` succeeds
- [ ] Match struct has #[derive(Serialize)]
- [ ] SearchOutput struct defined with all required fields
- [ ] serde::Serialize imported at top of file
</verification>

<success_criteria>

- Match struct can be serialized to JSON
- SearchOutput struct defines complete output schema
- Foundation ready for execution_id generation in 06-02
  </success_criteria>

<output>
After completion, create `.planning/phases/06-json-output/06-01-SUMMARY.md`
</output>
